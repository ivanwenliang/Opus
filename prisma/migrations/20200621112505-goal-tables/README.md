# Migration `20200621112505-goal-tables`

This migration has been generated by Ivan Liang at 6/21/2020, 11:25:05 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."AnnualGoal" (
"category" text  NOT NULL ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"goalStatement" text  NOT NULL ,"id" SERIAL,"nickname" text  NOT NULL ,"status" text  NOT NULL ,"userId" text  NOT NULL ,"year" integer  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."MonthlyGoal" (
"annualGoalId" integer  NOT NULL ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"goalStatement" text  NOT NULL ,"id" SERIAL,"month" integer  NOT NULL ,"status" text  NOT NULL ,"userId" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."WeeklyGoal" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"goalStatement" text  NOT NULL ,"id" SERIAL,"monthlyGoalId" integer  NOT NULL ,"status" text  NOT NULL ,"userId" text  NOT NULL ,"week" integer  NOT NULL ,
    PRIMARY KEY ("id"))

ALTER TABLE "public"."AnnualGoal" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."MonthlyGoal" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."MonthlyGoal" ADD FOREIGN KEY ("annualGoalId")REFERENCES "public"."AnnualGoal"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."WeeklyGoal" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."WeeklyGoal" ADD FOREIGN KEY ("monthlyGoalId")REFERENCES "public"."MonthlyGoal"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200615225700-user-profile..20200621112505-goal-tables
--- datamodel.dml
+++ datamodel.dml
@@ -2,18 +2,61 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
 }
 model User {
-  id          String   @id
-  email       String   @unique
-  displayName String?
-  photoURL    String?
-  createdAt   DateTime @default(now())
+  id           String        @id
+  email        String        @unique
+  displayName  String?
+  photoURL     String?
+  createdAt    DateTime      @default(now())
+  annualGoals  AnnualGoal[]
+  monthlyGoals MonthlyGoal[]
+  weeklyGoals  WeeklyGoal[]
 }
+
+// Consider a smaller period like quarters?
+model AnnualGoal {
+  id            Int           @id @default(autoincrement())
+  goalStatement String
+  category      String
+  nickname      String
+  status        String
+  createdAt     DateTime      @default(now())
+  year          Int
+  user          User          @relation(fields: [userId], references: [id])
+  userId        String
+  monthlyGoals  MonthlyGoal[]
+}
+
+// Each annual goal has 36 monthly goals?
+model MonthlyGoal {
+  id            Int          @id @default(autoincrement())
+  goalStatement String
+  status        String
+  createdAt     DateTime     @default(now())
+  month         Int
+  user          User         @relation(fields: [userId], references: [id])
+  userId        String
+  annualGoal    AnnualGoal   @relation(fields: [annualGoalId], references: [id])
+  annualGoalId  Int
+  weeklyGoals   WeeklyGoal[]
+}
+
+model WeeklyGoal {
+  id            Int         @id @default(autoincrement())
+  goalStatement String
+  status        String
+  createdAt     DateTime    @default(now())
+  week          Int
+  user          User        @relation(fields: [userId], references: [id])
+  userId        String
+  monthlyGoal   MonthlyGoal @relation(fields: [monthlyGoalId], references: [id])
+  monthlyGoalId Int
+}
```


